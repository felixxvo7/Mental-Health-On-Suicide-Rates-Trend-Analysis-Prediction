mental_health <- mental_health %>%
mutate(VALUE = ifelse(VALUE %in% c("E", "F"), NA, VALUE))
# Handle missing values
mental_health <- mental_health %>%
filter(!is.na(VALUE) & VALUE != "")
mental_health <- mental_health %>%
rename(
Year = REF_DATE,
Geography = GEO,
Age_Group = `Age.group`,
Unit = UOM
) %>%
mutate(
Year = as.numeric(Year),
Value = as.numeric(VALUE)
)
mental_health <- mental_health %>%
mutate(
Age_Group = case_when(
Age_Group == "Total, 15 years and over" ~ "15+ Years",
Age_Group == "15 to 24 years" ~ "15-24 Years",
Age_Group == "25 to 64 years" ~ "25-64 Years",
TRUE ~ Age_Group
)
)
View(mental_health)
mental_health <- read.csv("C:/Users/felix/Desktop/CODING/felix's works/Mental-Health-On-Suicide-Rates-Trend-Analysis-Prediction/datasets/raw/mental health CAN 02-22.csv")
# Handle missing values
mental_health <- mental_health %>%
filter(!is.na(VALUE) & VALUE != "")
mental_health <- mental_health %>%
rename(
Year = REF_DATE,
Geography = GEO,
Age_Group = `Age.group`,
Unit = UOM
) %>%
mutate(
Year = as.numeric(Year),
Value = as.numeric(VALUE)
)
mental_health <- mental_health %>%
mutate(
Age_Group = case_when(
Age_Group == "Total, 15 years and over" ~ "15+ Years",
Age_Group == "15 to 24 years" ~ "15-24 Years",
Age_Group == "25 to 64 years" ~ "25-64 Years",
TRUE ~ Age_Group
)
)
# Separate main values from confidence intervals
main_data <- mental_health %>%
filter(!str_detect(Characteristics, "confidence interval"))
ci_data <- mental_health %>%
filter(str_detect(Characteristics, "confidence interval")) %>%
mutate(CI_Type = ifelse(
str_detect(Characteristics, "Low"), "Low_CI", "High_CI")) %>%
select(-Characteristics) %>%
pivot_wider(names_from = CI_Type, values_from = Value)
final_data <- main_data %>%
left_join(ci_data, by = c("Year", "Geography", "Age_Group", "Gender", "Indicators"))
final_data <- final_data %>%
select(
Year, Geography, Age_Group, Gender,
Indicators, Value, Low_CI, High_CI
) %>%
filter(Year >= 2002 & Year <= 2022)
View(ci_data)
View(final_data)
View(final_data)
View(ci_data)
main_data <- main_data %>%
mutate(row_id = row_number())
ci_data <- ci_data %>%
mutate(row_id = row_number())
final_data <- main_data %>%
left_join(ci_data, by = c("Year", "Geography", "Age_Group", "Gender", "Indicators", "row_id")) %>%
select(-row_id)
View(final_data)
ggplot(final_data, aes(x = year, y = value, color = gender)) +
geom_ribbon(aes(ymin = low_ci, ymax = high_ci, fill = gender), alpha = 0.1) +
geom_line(linewidth = 1) +
geom_point(size = 2) +
facet_grid(indicators ~ age_group, scales = "free_y") +
labs(title = "Mental Health Trends in Canada (2002-2022)",
subtitle = "With 95% Confidence Intervals",
y = "Percentage (%)",
x = "Year") +
scale_x_continuous(breaks = seq(2000, 2022, 5)) +
scale_color_manual(values = c("Men+" = "#1f77b4", "Women+" = "#ff7f0e")) +
scale_fill_manual(values = c("Men+" = "#1f77b4", "Women+" = "#ff7f0e")) +
theme_minimal() +
theme(legend.position = "bottom",
strip.text = element_text(face = "bold"))
library(tidyverse)
mental_health <- read.csv("C:/Users/felix/Desktop/CODING/felix's works/Mental-Health-On-Suicide-Rates-Trend-Analysis-Prediction/datasets/raw/mental health CAN 02-22.csv")
# Handle missing values
mental_health <- mental_health %>%
filter(!is.na(VALUE) & VALUE != "")
mental_health <- mental_health %>%
rename(
Year = REF_DATE,
Geography = GEO,
Age_Group = `Age.group`,
Unit = UOM
) %>%
mutate(
Year = as.numeric(Year),
Value = as.numeric(VALUE)
)
mental_health <- mental_health %>%
mutate(
Age_Group = case_when(
Age_Group == "Total, 15 years and over" ~ "15+ Years",
Age_Group == "15 to 24 years" ~ "15-24 Years",
Age_Group == "25 to 64 years" ~ "25-64 Years",
TRUE ~ Age_Group
)
)
# Separate main values from confidence intervals
main_data <- mental_health %>%
filter(!str_detect(Characteristics, "confidence interval"))
ci_data <- mental_health %>%
filter(str_detect(Characteristics, "confidence interval")) %>%
mutate(CI_Type = ifelse(
str_detect(Characteristics, "Low"), "Low_CI", "High_CI")) %>%
select(-Characteristics) %>%
pivot_wider(names_from = CI_Type, values_from = Value)
main_data <- main_data %>%
mutate(row_id = row_number())
ci_data <- ci_data %>%
mutate(row_id = row_number())
final_data <- main_data %>%
left_join(ci_data, by = c("Year", "Geography", "Age_Group", "Gender", "Indicators", "row_id")) %>%
select(-row_id)
ggplot(final_data, aes(x = year, y = value, color = gender)) +
geom_ribbon(aes(ymin = low_ci, ymax = high_ci, fill = gender), alpha = 0.1) +
geom_line(linewidth = 1) +
geom_point(size = 2) +
facet_grid(indicators ~ age_group, scales = "free_y") +
labs(title = "Mental Health Trends in Canada (2002-2022)",
subtitle = "With 95% Confidence Intervals",
y = "Percentage (%)",
x = "Year") +
scale_x_continuous(breaks = seq(2000, 2022, 5)) +
scale_color_manual(values = c("Men+" = "#1f77b4", "Women+" = "#ff7f0e")) +
scale_fill_manual(values = c("Men+" = "#1f77b4", "Women+" = "#ff7f0e")) +
theme_minimal() +
theme(legend.position = "bottom",
strip.text = element_text(face = "bold"))
# 1. Check column names after preprocessing
names(final_data)
# 2. Verify indicators column exists - if not, fix upstream:
final_data <- final_data %>%
rename(indicators = Indicators) # Adjust capitalization if needed
# 3. Modified visualization code
ggplot(final_data, aes(x = year, y = value, color = gender)) +
geom_ribbon(aes(ymin = low_ci, ymax = high_ci, fill = gender), alpha = 0.1) +
geom_line(linewidth = 1) +
geom_point(size = 2) +
facet_grid(indicators ~ age_group, scales = "free_y") + # Ensure match
labs(title = "Mental Health Trends in Canada (2002-2022)",
subtitle = "With 95% Confidence Intervals",
y = "Percentage (%)",
x = "Year") +
scale_x_continuous(breaks = seq(2000, 2022, 5)) +
theme_minimal()
# 1. Check column names after preprocessing
names(final_data)
# 2. Verify indicators column exists - if not, fix upstream:
final_data <- final_data %>%
rename(indicators = Indicators) # Adjust capitalization if needed
# 3. Modified visualization code
ggplot(final_data, aes(x = year, y = value, color = gender)) +
geom_ribbon(aes(ymin = low_ci, ymax = high_ci, fill = gender), alpha = 0.1) +
geom_line(linewidth = 1) +
geom_point(size = 2) +
facet_grid(indicators ~ Age_Group, scales = "free_y") + # Ensure match
labs(title = "Mental Health Trends in Canada (2002-2022)",
subtitle = "With 95% Confidence Intervals",
y = "Percentage (%)",
x = "Year") +
scale_x_continuous(breaks = seq(2000, 2022, 5)) +
theme_minimal()
unique(mental_health$Indicators)
mental_health <- read.csv("C:/Users/felix/Desktop/CODING/felix's works/Mental-Health-On-Suicide-Rates-Trend-Analysis-Prediction/datasets/raw/mental health CAN 02-22.csv")
# Handle missing values
mental_health <- mental_health %>%
filter(!is.na(VALUE) & VALUE != "")
mental_health <- read.csv("C:/Users/felix/Desktop/CODING/felix's works/Mental-Health-On-Suicide-Rates-Trend-Analysis-Prediction/datasets/raw/mental health CAN 02-22.csv")
# Handle missing values
mental_health <- mental_health %>%
filter(!is.na(VALUE) & VALUE != "")
mental_health <- read.csv("C:/Users/felix/Desktop/CODING/felix's works/Mental-Health-On-Suicide-Rates-Trend-Analysis-Prediction/datasets/raw/mental health CAN 02-22.csv")
# Handle missing values
mental_health <- mental_health %>%
filter(!is.na(VALUE) & VALUE != "")
library(tidyverse)
mental_health <- read.csv("C:/Users/felix/Desktop/CODING/felix's works/Mental-Health-On-Suicide-Rates-Trend-Analysis-Prediction/datasets/raw/mental health CAN 02-22.csv")
# Handle missing values
mental_health <- mental_health %>%
filter(!is.na(VALUE) & VALUE != "")
mental_health <- mental_health %>%
rename(
Year = REF_DATE,
Geography = GEO,
Age_Group = `Age.group`,
Unit = UOM
) %>%
mutate(
Year = as.numeric(Year),
Value = as.numeric(VALUE)
)
mental_health <- mental_health %>%
mutate(
Age_Group = case_when(
Age_Group == "Total, 15 years and over" ~ "15+ Years",
Age_Group == "15 to 24 years" ~ "15-24 Years",
Age_Group == "25 to 64 years" ~ "25-64 Years",
TRUE ~ Age_Group
)
)
head(mental_health)
mental_health <- read.csv("C:/Users/felix/Desktop/CODING/felix's works/Mental-Health-On-Suicide-Rates-Trend-Analysis-Prediction/datasets/raw/mental health CAN 02-22.csv")
# Handle missing values
mental_health <- mental_health %>%
filter(!is.na(VALUE) & VALUE != "")
mental_health <- mental_health %>%
rename(
Year = REF_DATE,
Geography = GEO,
Age_Group = `Age.group`,
Unit = UOM
) %>%
mutate(
Year = as.numeric(Year),
Value = as.numeric(VALUE)
)
mental_health <- mental_health %>%
mutate(
Age_Group = case_when(
Age_Group == "Total, 15 years and over" ~ "15+ Years",
Age_Group == "15 to 24 years" ~ "15-24 Years",
Age_Group == "25 to 64 years" ~ "25-64 Years",
TRUE ~ Age_Group
)
)
head(mental_health)
library(tidyverse)
library(plotly)
library(scales)
library(tidyverse)
library(plotly)
library(scales)
# Separate confidence intervals
ci_data <- mental_health %>%
filter(str_detect(Characteristics, "confidence interval")) %>%
mutate(CI_Type = ifelse(str_detect(Characteristics, "Low"), "Low_CI", "High_CI")) %>%
select(Year, Geography, Age_Group, Gender, Indicators, CI_Type, Value) %>%
pivot_wider(names_from = CI_Type, values_from = Value)
main_data <- mental_health %>%
filter(!str_detect(Characteristics, "confidence interval")) %>%
left_join(ci_data, by = c("Year", "Geography", "Age_Group", "Gender", "Indicators"))
# Separate confidence intervals
ci_data <- mental_health %>%
filter(str_detect(Characteristics, "confidence interval")) %>%
mutate(CI_Type = ifelse(str_detect(Characteristics, "Low"), "Low_CI", "High_CI")) %>%
select(Year, Geography, Age_Group, Gender, Indicators, CI_Type, Value) %>%
pivot_wider(names_from = CI_Type, values_from = Value)
main_data <- mental_health %>%
filter(!str_detect(Characteristics, "confidence interval")) %>%
left_join(ci_data, by = c("Year", "Geography", "Age_Group", "Gender", "Indicators"))
# Separate confidence intervals
ci_data <- mental_health %>%
filter(str_detect(Characteristics, "confidence interval")) %>%
mutate(CI_Type = ifelse(str_detect(Characteristics, "Low"), "Low_CI", "High_CI")) %>%
select(Year, Geography, Age_Group, Gender, Indicators, CI_Type, Value) %>%
pivot_wider(names_from = CI_Type, values_from = Value)
main_data <- mental_health %>%
filter(!str_detect(Characteristics, "confidence interval")) %>%
left_join(ci_data, by = c("Year", "Geography", "Age_Group", "Gender", "Indicators"))
main_data
mental_health <- read.csv("C:/Users/felix/Desktop/CODING/felix's works/Mental-Health-On-Suicide-Rates-Trend-Analysis-Prediction/datasets/raw/mental health CAN 02-22.csv")
# Handle missing values
mental_health <- mental_health %>%
filter(!is.na(VALUE) & VALUE != "")
mental_health <- mental_health %>%
rename(
Year = REF_DATE,
Geography = GEO,
Age_Group = `Age.group`,
Unit = UOM
) %>%
mutate(
Year = as.numeric(Year),
Value = as.numeric(VALUE)
)
mental_health <- mental_health %>%
mutate(
Age_Group = case_when(
Age_Group == "Total, 15 years and over" ~ "15+ Years",
Age_Group == "15 to 24 years" ~ "15-24 Years",
Age_Group == "25 to 64 years" ~ "25-64 Years",
TRUE ~ Age_Group
)
)
# Check the first few rows of the dataset
head(mental_health)
# Summary statistics
summary(mental_health)
mental_health <- mental_health %>%
mutate(
Age_Group = case_when(
Age_Group == "Total, 15 years and over" ~ "15+ Years",
Age_Group == "15 to 24 years" ~ "15-24 Years",
Age_Group == "25 to 64 years" ~ "25-64 Years",
TRUE ~ Age_Group
)
)
# Summary statistics
summary(mental_health)
mental_health <- read.csv("C:/Users/felix/Desktop/CODING/felix's works/Mental-Health-On-Suicide-Rates-Trend-Analysis-Prediction/datasets/raw/mental health CAN 02-22.csv"
mental_health <- read.csv("C:/Users/felix/Desktop/CODING/felix's works/Mental-Health-On-Suicide-Rates-Trend-Analysis-Prediction/datasets/raw/mental health CAN 02-22.csv")
mental_health <- read.csv("C:/Users/felix/Desktop/CODING/felix's works/Mental-Health-On-Suicide-Rates-Trend-Analysis-Prediction/datasets/raw/mental health CAN 02-22.csv")
# Handle missing values
mental_health <- mental_health %>%
filter(!is.na(VALUE) & VALUE != "")
mental_health <- mental_health %>%
rename(
Year = REF_DATE,
Geography = GEO,
Age_Group = `Age.group`,
Unit = UOM
) %>%
mutate(
Year = as.numeric(Year),
Value = as.numeric(VALUE)
)
mental_health <- mental_health %>%
mutate(
Age_Group = case_when(
Age_Group == "Total, 15 years and over" ~ "15+ Years",
Age_Group == "15 to 24 years" ~ "15-24 Years",
Age_Group == "25 to 64 years" ~ "25-64 Years",
TRUE ~ Age_Group
)
)
# Summary statistics
summary(mental_health)
mental_health <- read.csv("C:/Users/felix/Desktop/CODING/felix's works/Mental-Health-On-Suicide-Rates-Trend-Analysis-Prediction/datasets/raw/mental health CAN 02-22.csv")
mental_health <- mental_health %>%
rename(
Year = REF_DATE,
Geography = GEO,
Age_Group = `Age.group`,
Unit = UOM
) %>%
mutate(
Year = as.numeric(Year),
Value = as.numeric(VALUE)
)
mental_health <- mental_health %>%
mutate(
Age_Group = case_when(
Age_Group == "Total, 15 years and over" ~ "15+ Years",
Age_Group == "15 to 24 years" ~ "15-24 Years",
Age_Group == "25 to 64 years" ~ "25-64 Years",
TRUE ~ Age_Group
)
)
# Summary statistics
summary(mental_health)
ggplot(mental_health, aes(x = Indicators, fill = Indicators)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Distribution of Mental Health Indicators",
x = "Indicators",
y = "Count")
ggplot(mental_health, aes(x = Indicators, fill = Indicators)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(title = "Distribution of Mental Health Indicators",
x = "Indicators",
y = "Count")
library(tidyverse)
library(plotly)
library(scales)
mental_health <- read.csv("C:/Users/felix/Desktop/CODING/felix's works/Mental-Health-On-Suicide-Rates-Trend-Analysis-Prediction/datasets/raw/mental health CAN 02-22.csv")
mental_health <- mental_health %>%
rename(
Year = REF_DATE,
Geography = GEO,
Age_Group = `Age.group`,
Unit = UOM
) %>%
mutate(
Year = as.numeric(Year),
Value = as.numeric(VALUE)
)
mental_health <- mental_health %>%
mutate(
Age_Group = case_when(
Age_Group == "Total, 15 years and over" ~ "15+ Years",
Age_Group == "15 to 24 years" ~ "15-24 Years",
Age_Group == "25 to 64 years" ~ "25-64 Years",
TRUE ~ Age_Group
)
)
# Summary statistics
summary(mental_health)
mental_health %>%
filter(Unit == "Percent") %>%
group_by(Year, Indicators) %>%
summarise(Average_Value = mean(Value, na.rm = TRUE)) %>%
ggplot(aes(x = Year, y = Average_Value, color = Indicators)) +
geom_line() +
labs(title = "Trends in Mental Health Indicators Over Time",
x = "Year",
y = "Average Percentage")
mental_health %>%
filter(Unit == "Percent") %>%
group_by(Age_Group, Indicators) %>%
summarise(Average_Value = mean(Value, na.rm = TRUE)) %>%
ggplot(aes(x = Age_Group, y = Average_Value, fill = Indicators)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Mental Health Indicators by Age Group",
x = "Age Group",
y = "Average Percentage")
mental_health %>%
filter(Unit == "Percent") %>%
group_by(Gender, Indicators) %>%
summarise(Average_Value = mean(Value, na.rm = TRUE)) %>%
ggplot(aes(x = Gender, y = Average_Value, fill = Indicators)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Mental Health Indicators by Gender",
x = "Gender",
y = "Average Percentage")
mental_health %>%
filter(Indicators == "Mental health service use (12mo)") %>%
ggplot(aes(x = Value)) +
geom_histogram(binwidth = 5, fill = "blue", color = "black") +
labs(title = "Distribution of Mental Health Service Use",
x = "Percentage of Population",
y = "Count")
mental_health %>%
filter(Indicators == "Suicidal ideation (Life/12mo)") %>%
group_by(Year) %>%
summarise(Average_Value = mean(Value, na.rm = TRUE)) %>%
ggplot(aes(x = Year, y = Average_Value)) +
geom_line(color = "red") +
labs(title = "Trends in Suicidal Ideation Over Time",
x = "Year",
y = "Average Percentage")
key_indicators <- c(
"Major depressive episode, life",
"Generalized anxiety disorder, life",
"Suicidal ideation, life",
"Mental health service use, 12mo",
"Self-rated mental health, fair/poor"
)
mental_health_filtered <- mental_health %>%
filter(Indicators %in% key_indicators)
key_indicators <- c(
"Major depressive episode, life",
"Generalized anxiety disorder, life",
"Suicidal ideation, life",
"Mental health service use, 12mo",
"Self-rated mental health, fair/poor"
)
mental_health_filtered <- mental_health %>%
filter(Indicators %in% key_indicators)
# Visualization 1: Trends in Key Mental Health Indicators Over Time
mental_health_filtered %>%
filter(Unit == "Percent") %>%
group_by(Year, Indicators) %>%
summarise(Average_Value = mean(Value, na.rm = TRUE)) %>%
ggplot(aes(x = Year, y = Average_Value, color = Indicators)) +
geom_line(size = 1) +
labs(title = "Trends in Key Mental Health Indicators Over Time",
x = "Year",
y = "Average Percentage") +
theme_minimal() +
theme(legend.position = "bottom")
mental_health_filtered %>%
filter(Unit == "Percent") %>%
group_by(Age_Group, Indicators) %>%
summarise(Average_Value = mean(Value, na.rm = TRUE)) %>%
ggplot(aes(x = Age_Group, y = Average_Value, fill = Indicators)) +
geom_bar(stat = "identity", position = "dodge") +
labs(title = "Key Mental Health Indicators by Age Group",
x = "Age Group",
y = "Average Percentage") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
mental_health_filtered %>%
filter(Indicators == "Mental health service use, 12mo") %>%
ggplot(aes(x = Value)) +
geom_histogram(binwidth = 5, fill = "blue", color = "black") +
labs(title = "Distribution of Mental Health Service Use",
x = "Percentage of Population",
y = "Count") +
theme_minimal()
mental_health_filtered %>%
filter(Indicators == "Suicidal ideation, life") %>%
group_by(Year) %>%
summarise(Average_Value = mean(Value, na.rm = TRUE)) %>%
ggplot(aes(x = Year, y = Average_Value)) +
geom_line(color = "red", size = 1) +
labs(title = "Trends in Suicidal Ideation Over Time",
x = "Year",
y = "Average Percentage") +
theme_minimal()
